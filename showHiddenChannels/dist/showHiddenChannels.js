function N(n){window.enmity.plugins.registerPlugin(n)}function P(n){return window.enmity.patcher.create(n)}function a(...n){return window.enmity.getModuleByProps(n)}function m(){const n=new WebSocket("ws://10.0.0.83:1234");let e=!1,r=!1;const u=[];n.onopen=()=>{e=!0;for(const s of u)n.send(s)},n.onerror=()=>r=!0;const C=Object.keys(t);function p(s,...y){if(r)return;const g={time:Date.now(),type:s,arguments:y,delayed:!1};if(!e)return g.delayed=!0,u.push(JSON.stringify(g));n.send(JSON.stringify(g))}const E=C.map(s=>[s,p.bind(this,s)]);return Object.fromEntries(E)}const t=m(),d=a("getChannelPermissions").default;t.log("got getChannelPermissions");const l=a("hasUnread").default;t.log("got unreadManager");const{getChannel:_}=a("getChannel").default;t.log("got getChannel");const{Permissions:f,ChannelTypes:o}=a("Permissions");t.log("got Permissions");const w=d.can.bind({});t.log("got originalCan");const i=P("showHiddenChannels"),h={ignore:[o.DM,o.GROUP_DM,o.GUILD_CATEGORY],good:[o.GUILD_TEXT,o.GUILD_VOICE,o.GUILD_STAGE_VOICE,o.GUILD_ANNOUNCEMENT,o.ANNOUNCEMENT_THREAD,o.PRIVATE_THREAD,o.PUBLIC_THREAD]};t.log("got channelTypes");const c=n=>{let e=n;return typeof n=="string"&&(e=_(n)),!e||h.ignore.includes(e.type)?!0:h.good.includes(e.type)&&w(f.VIEW_CHANNEL,e)};t.log("got userCanViewChannel");const A={name:"showHiddenChannels",patches:[],onStart(){t.log("onStart"),i.after(d,"can",(n,[e],r)=>{if(e===f.VIEW_CHANNEL)return!0}),i.after(l,"hasUnread",(n,e,r)=>{if(!c(e[0]))return!1}),i.after(l,"hasUnreadPins",(n,e,r)=>{if(!c(e[0]))return!1}),i.after(l,"getMentionCount",(n,e,r)=>{if(!c(e[0]))return 0})},onStop(){t.log("onStop"),i.unpatchAll()}};N(A);
