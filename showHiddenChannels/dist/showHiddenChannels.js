function C(e){window.enmity.plugins.registerPlugin(e)}function g(e){return window.enmity.patcher.create(e)}function t(...e){return window.enmity.getModuleByProps(e)}function c(){const e=new WebSocket("ws://10.0.0.83:1234");let r=!1,s=!1,l=[];return e.onopen=()=>{r=!0;for(const u of l)e.send(u)},e.onerror=()=>s=!0,new Proxy({},{get:(u,y)=>(...p)=>{if(s)return;const o={time:Date.now(),type:y,arguments:p,delayed:!1};if(!r)return o.delayed=!0,l.push(JSON.stringify(o));e.send(JSON.stringify(o))}})}const h=c(),a=g("showHiddenChannels"),n={channelPerms:t("getChannelPermissions").default,unreadManager:t("hasUnread").default,channelStore:t("getChannel").default,Permissions:t("Permissions").Permissions,ChannelTypes:t("ChannelTypes").ChannelTypes},f=n.channelPerms.can.bind({}),d={ignore:[n.ChannelTypes.DM,n.ChannelTypes.GROUP_DM,n.ChannelTypes.GUILD_CATEGORY],good:[n.ChannelTypes.GUILD_TEXT,n.ChannelTypes.GUILD_VOICE,n.ChannelTypes.GUILD_STAGE_VOICE,n.ChannelTypes.GUILD_ANNOUNCEMENT,n.ChannelTypes.ANNOUNCEMENT_THREAD,n.ChannelTypes.PRIVATE_THREAD,n.ChannelTypes.PUBLIC_THREAD]};function i(e){let r=e;return typeof e=="string"&&(r=n.channelStore.getChannel(e)),!r||d.ignore.includes(r.type)?!0:d.good.includes(r.type)&&f(n.Permissions.VIEW_CHANNEL,r)}C({name:"showHiddenChannels",patches:[],onStart(){a.after(n.channelPerms,"can",(e,[r],s)=>{if(r===n.Permissions.VIEW_CHANNEL)return!0}),a.after(n.unreadManager,"hasUnread",(e,r,s)=>{if(!i(r[0]))return!1}),a.after(n.unreadManager,"hasUnreadPins",(e,r,s)=>{if(!i(r[0]))return!1}),a.after(n.unreadManager,"getMentionCount",(e,r,s)=>{if(!i(r[0]))return 0}),h.log("onStart")},onStop(){a.unpatchAll(),h.log("onStop")}});
